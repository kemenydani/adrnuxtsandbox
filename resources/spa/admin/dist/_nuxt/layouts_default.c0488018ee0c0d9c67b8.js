webpackJsonp([4],{Ma2J:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("SW+Z"),i=r("STrE"),s=r("VU/8")(n.a,i.a,!1,null,null,null);s.options.__file="layouts\\default.vue",e.default=s.exports},STrE:function(t,e,r){"use strict";var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-app",[r("v-navigation-drawer",{attrs:{"mini-variant":t.miniVariant,clipped:t.clipped,fixed:"",app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[r("v-list",t._l(t.items,function(e,n){return r("v-list-tile",{key:n,attrs:{router:"",to:e.to,exact:""}},[r("v-list-tile-action",[r("v-icon",{domProps:{innerHTML:t._s(e.icon)}})],1),r("v-list-tile-content",[r("v-list-tile-title",{domProps:{textContent:t._s(e.title)}})],1)],1)}))],1),r("v-toolbar",{attrs:{color:"primary","clipped-left":t.clipped,fixed:"",app:"",dark:""}},[r("v-toolbar-side-icon",{on:{click:function(e){t.drawer=!t.drawer}}}),r("v-toolbar-title",{domProps:{textContent:t._s(t.title)}}),r("v-spacer"),r("v-badge",{staticClass:"mr-2",attrs:{overlap:"",color:"red"}},[t.authUserActiveNotificationCount?r("span",{attrs:{slot:"badge"},slot:"badge"},[t._v("\n        "+t._s(t.authUserActiveNotificationCount)+"\n      ")]):t._e(),r("v-icon",{attrs:{medium:"",large:"",color:"white"},on:{click:function(e){e.stopPropagation(),t.rightDrawer=!t.rightDrawer}}},[t._v("\n        notifications\n      ")])],1),r("v-badge",{staticClass:"ml-2",attrs:{overlap:"",color:"red"}},[t.authUserActiveConversationCount?r("span",{attrs:{slot:"badge"},slot:"badge"},[t._v("\n        "+t._s(t.authUserActiveConversationCount)+"\n      ")]):t._e(),r("v-icon",{attrs:{medium:"",large:"",color:"white"},on:{click:function(e){e.stopPropagation(),t.rightDrawer=!t.rightDrawer}}},[t._v("\n        email\n      ")])],1)],1),r("v-content",[r("v-container",[r("nuxt")],1)],1),r("v-navigation-drawer",{attrs:{app:"",right:t.right,fixed:""},model:{value:t.rightDrawer,callback:function(e){t.rightDrawer=e},expression:"rightDrawer"}},[r("v-list",[r("v-list-tile",[r("v-list-tile-avatar",[r("img")]),r("v-list-tile-content",[r("v-list-tile-title",[t._v(t._s(t.authUser.UserName))])],1),r("v-list-tile-action",[r("v-btn",{attrs:{fab:"",title:"logout",depressed:"",small:"",color:"red"},on:{click:function(e){return e.stopPropagation(),t.onSignOut(e)}}},[r("v-icon",{attrs:{color:"white"}},[t._v("power_settings_new")])],1)],1)],1)],1),r("v-list-tile",{attrs:{color:"primary"}},[r("h3",[t._v("Timeline")])]),r("v-list",{attrs:{dense:""}},[t._l(t.authUserNotifications,function(e,n){return[r("v-divider",{key:"divider"+n}),r("v-list-tile",{key:"item"+n},[r("v-list-tile-content",[1==e.Touched?r("v-list-tile-sub-title",[t._v(t._s(e.Message))]):r("v-list-tile-title",[t._v(t._s(e.Message))])],1)],1)]}),r("v-list-tile",{attrs:{color:"primary"}},[r("v-list-tile-title",{staticClass:"text-xs-right"},[t._v("History »")])],1)],2),r("v-list-tile",{attrs:{color:"primary"}},[r("h3",[t._v("Inbox")])]),t.authUserConversations&&t.authUserConversations.length?r("v-list",{attrs:{"two-line":""}},[t._l(t.authUserConversations,function(e,n){return[r("v-divider",{key:"divider"+n}),r("v-list-tile",{key:"item"+n,attrs:{avatar:"",ripple:""},nativeOn:{click:function(e){t.openConversation(n)}}},[r("v-list-tile-content",[r("v-list-tile-title",[t._v(t._s(e.LastMessageUser))]),r("v-list-tile-sub-title",[t._v(t._s(e.LastMessageText))]),r("v-list-tile-sub-title")],1),r("v-list-tile-action",[r("v-icon",[t._v("\n              mail\n            ")])],1)],1)]}),r("v-list-tile",{attrs:{color:"primary"}},[r("v-list-tile-title",{staticClass:"text-xs-right"},[t._v("History »")])],1)],2):t._e()],1)],1)};n._withStripped=!0;var i={render:n,staticRenderFns:[]};e.a=i},"SW+Z":function(t,e,r){"use strict";var n=r("mvHQ"),i=r.n(n),s=r("Xxa5"),a=r.n(s),o=r("exGp"),u=r.n(o);e.a={name:"layoutDefault",middleware:"auth",data:function(){return{clipped:!1,drawer:!0,fixed:!1,items:[{icon:"apps",title:"Welcome",to:"/"},{icon:"bubble_chart",title:"Articles",to:"/article"},{icon:"group",title:"Users",to:"/user"}],miniVariant:!1,right:!0,rightDrawer:!1,title:"Dashboard",services:{notification:{updateInterval:2e4},conversation:{updateInterval:1e4,focusedUpdateInterval:5e3,focused:!1}}}},computed:{isAuthenticated:function(){return this.$store.getters.getIsAuthenticated},authUser:function(){return this.$store.getters.getAuthUser},authUserNotifications:function(){return this.$store.getters.getAuthUserNotifications},authUserConversations:function(){return this.$store.getters.getAuthUserConversations},authUserActiveNotificationCount:function(){return this.$store.getters.getAuthUserActiveNotificationCount},authUserActiveConversationCount:function(){return this.$store.getters.getAuthUserActiveConversationCount}},methods:{onSignOut:function(){var t=u()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("api/signout",{credentials:"include",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}});case 2:200===t.sent.status&&(this.$store.dispatch("setAuthUser",{}),this.$router.push("auth"));case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),openConversation:function(t){this.updateAuthUserConversations().then(function(e){console.log(e[t])})},postConversationMessage:function(){var t=u()(a.a.mark(function t(e,r){var n,i,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(n=new FormData).append("ConversationId",e),n.append("Text",r),t.next=5,fetch("api/user/conversation_message",{credentials:"include",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:n});case 5:return i=t.sent,t.next=8,i.json();case 8:return s=t.sent,console.log(s),t.abrupt("return",s);case 11:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}(),updateAuthUserNotifications:function(){var t=u()(a.a.mark(function t(){var e,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/user/notifications",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});case 2:if(200===(e=t.sent).status){t.next=5;break}return t.abrupt("return",!1);case 5:if(e.json){t.next=7;break}return t.abrupt("return",!1);case 7:return t.next=9,e.json();case 9:r=t.sent,t.prev=10,i()(r),t.next=17;break;case 14:return t.prev=14,t.t0=t.catch(10),t.abrupt("return",!1);case 17:return this.$store.dispatch("setAuthUserNotifications",r||[]),t.abrupt("return",this.authUserNotifications);case 19:case"end":return t.stop()}},t,this,[[10,14]])}));return function(){return t.apply(this,arguments)}}(),updateAuthUserConversations:function(){var t=u()(a.a.mark(function t(){var e,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/user/conversations",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});case 2:if(200===(e=t.sent).status){t.next=5;break}return t.abrupt("return",!1);case 5:if(e.json){t.next=7;break}return t.abrupt("return",!1);case 7:return t.next=9,e.json();case 9:r=t.sent,t.prev=10,i()(r),t.next=17;break;case 14:return t.prev=14,t.t0=t.catch(10),t.abrupt("return",!1);case 17:return this.$store.dispatch("setAuthUserConversations",r||[]),t.abrupt("return",this.authUserConversations);case 19:case"end":return t.stop()}},t,this,[[10,14]])}));return function(){return t.apply(this,arguments)}}()},created:function(){var t=this;this.isAuthenticated&&(this.updateAuthUserNotifications(),this.updateAuthUserConversations(),setInterval(function(){return t.updateAuthUserNotifications()},this.services.notification.updateInterval),setInterval(function(){return t.updateAuthUserConversations()},this.services.conversation.updateInterval))}}}});